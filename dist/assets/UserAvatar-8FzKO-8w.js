import{o as d,c as L,a as l,u as R,r,e as v,f as a,g as o,v as V,Z as b,bB as x,E as p,p as S,l as z}from"./index-db_mjOVI.js";import{a as $,E as j}from"./el-col-fvDdf1HD.js";import{_ as M,E as N}from"./plus-5sq-bqZ8.js";import{_ as P,E as T}from"./_plugin-vue_export-helper-Dg3XgOsB.js";import{P as q}from"./PageContainer-C7DIgtre.js";import"./_baseClone-kySqY0Uo.js";import"./isEqual-WJw22_c8.js";const D={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},H=l("path",{fill:"currentColor",d:"M160 832h704a32 32 0 1 1 0 64H160a32 32 0 1 1 0-64m384-578.304V704h-64V247.296L237.248 490.048L192 444.8L508.8 128l316.8 316.8l-45.312 45.248z"},null,-1),J=[H];function O(s,c){return d(),L("svg",D,[...J])}const W={name:"ep-upload",render:O},Z="/assets/avatar-kJTWkE7i.jpg",g=s=>(S("data-v-e6e0aa6c"),s=s(),z(),s),F=["src"],G=g(()=>l("span",null,"选择图片",-1)),K=g(()=>l("span",null,"上传头像",-1)),Q={__name:"UserAvatar",setup(s){const{userInfo:{user_pic:c},getUserInfo:h}=R(),_=r(c||""),f=r(),w=()=>{f.value.$el.querySelector("input").click()},n=r(!1),U=e=>e.type!=="image/jpeg"?(p.error("上传图片格式错误"),!1):e.size/1024/1024>2?(p.error("图片应小于2MB"),!1):!0,u=r(c||""),E=async e=>{await U(e.raw)&&(u.value=URL.createObjectURL(e.raw),k(e.raw))},k=e=>{const t=new FileReader;t.readAsDataURL(e),t.onload=()=>{_.value=t.result},t.onerror=function(i){console.log(i)}},y=async()=>{n.value=!0,await x(_.value),h(),n.value=!1,p.success("上传成功")};return(e,t)=>{const i=M,m=T,B=W,A=N,C=$,I=j;return d(),v(q,{title:"更换头像"},{content:a(()=>[o(I,null,{default:a(()=>[o(C,{span:12},{default:a(()=>[o(A,{ref_key:"uploadRef",ref:f,class:"avatar-uploader","auto-upload":!1,"show-file-list":!1,"on-change":E},{trigger:a(()=>[l("img",{src:u.value?u.value:V(Z),class:"avatar"},null,8,F)]),default:a(()=>[o(m,{type:"primary",size:"large",onClick:w},{default:a(()=>[o(i),G]),_:1}),o(m,{type:"success",size:"large",disabled:!_.value,onClick:y,loading:n.value},{default:a(()=>[n.value?b("",!0):(d(),v(B,{key:0})),K]),_:1},8,["disabled","loading"])]),_:1},512)]),_:1})]),_:1})]),_:1})}}},ne=P(Q,[["__scopeId","data-v-e6e0aa6c"]]);export{ne as default};
